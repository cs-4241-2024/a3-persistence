let isEdit=-1,isEditClicked=!1;
const submit=async e=>{e.preventDefault();
  const input=document.querySelector('#item'),input2=document.querySelector('#description'),input3=document.querySelector('#cost'),input4=document.querySelector('#tax'),inputId=document.querySelector('#itemId'),json={item:input.value,description:input2.value,cost:input3.value,tax:input4.value,total:0,tag:isEdit,user:sessionUser,_id:inputId.value},body=JSON.stringify(json);
  if(isEditClicked){console.log('Save item:',json),isEditClicked=!1;
    const r=await fetch('/update',{method:'PUT',headers:{'Content-Type':'application/json'},body});
    const d=await r.json();console.log(d,"Data received"),updateTable(d)}else{console.log(json,"client side");
      const r=await fetch('/add',{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify(json)});
      let d=await r.json();
      console.log("This is what is being returned: ",d),updateTable(d)}input.value='',input2.value='',input3.value='',input4.value='',isEdit=-1};
      function editItem(item){console.log('Edit item:',item),document.getElementById("item").value=item.item,document.getElementById("description").value=item.description,document.getElementById("cost").value=item.cost,document.getElementById("tax").value=item.tax,document.getElementById("itemId").value=item._id,isEditClicked=!0}function updateTable(data){console.log('Data received:',data);
        const table=document.getElementById("list");
        table.innerHTML=`<tr><th>Item</th><th>Description</th><th>Cost</th><th>Tax</th><th>Total</th><th>Edit</th><th>Delete</th></tr>`;
        let tbody=document.createElement('tbody');
        data.forEach(item=>{let tr=document.createElement('tr');
          tr.setAttribute('id',item.tag);
          let td1=document.createElement('td');
          td1.appendChild(document.createTextNode(item.item));
          let td2=document.createElement('td');
          td2.appendChild(document.createTextNode(item.description));
          let td3=document.createElement('td');
          td3.appendChild(document.createTextNode(item.cost));
          let td4=document.createElement('td');
          td4.appendChild(document.createTextNode(item.tax));
          let td5=document.createElement('td');
          td5.appendChild(document.createTextNode(item.total));
          let td6=document.createElement('td'),editButton=document.createElement('button');
          editButton.textContent='Edit',editButton.addEventListener('click',()=>editItem(item)),td6.appendChild(editButton);
          let td7=document.createElement('td'),deleteButton=document.createElement('button');
          deleteButton.textContent='Delete',deleteButton.addEventListener('click',()=>deleteItem(item._id)),td7.appendChild(deleteButton),tr.appendChild(td1),tr.appendChild(td2),tr.appendChild(td3),tr.appendChild(td4),tr.appendChild(td5),tr.appendChild(td6),tr.appendChild(td7),tbody.appendChild(tr)}),table.appendChild(tbody)}async function deleteItem(id){console.log('Delete this item with id:',id);
            const response=await fetch('/remove',{method:'DELETE',headers:{'Content-Type':'application/json'},body:JSON.stringify({_id:id})});
            const data=await response.json();
            console.log('Data received after deletion:',data),updateTable(data)}async function loadTable(){const response=await fetch('/load',{method:'GET',headers:{'Content-Type':'application/json'}});
            let data=await response.json();
            updateTable(data)}window.onload=function(){console.log(sessionStorage.getItem('username')," This is the session"),sessionUser=sessionStorage.getItem('username');
              const button=document.querySelector("button");
              button.onclick=submit,loadTable()};
